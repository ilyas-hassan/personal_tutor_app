<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎓 AI Personal Tutor - Free & Open Source</title>
    
    <!-- SEO & Social Meta Tags -->
    <meta name="description" content="Free, privacy-first AI personal tutor running entirely in your browser. No API keys, no server, 100% local processing.">
    <meta name="keywords" content="AI tutor, machine learning, education, privacy, WebLLM, Phi-3">
    <meta name="author" content="AI Personal Tutor">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="AI Personal Tutor - Learn Anything, Privately">
    <meta property="og:description" content="Free AI-powered personal tutor with 100% privacy. No API keys needed.">
    <meta property="og:url" content="https://ilyas-hassan.github.io/personal_tutor_app/">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AI Personal Tutor">
    <meta name="twitter:description" content="Free, privacy-first AI tutor in your browser">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="AI Tutor">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
    <link rel="apple-touch-icon" href="/icon-192.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('✅ Service Worker registered:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('New version available! Reload to update?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch(error => {
                        console.log('❌ Service Worker registration failed:', error);
                    });
            });
            
            // Handle service worker updates
            let refreshing = false;
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                if (!refreshing) {
                    refreshing = true;
                    window.location.reload();
                }
            });
        }
    </script>
</head>
<body>
    <!-- Install PWA Banner -->
    <div id="installBanner" class="install-banner" style="display: none;">
        <div class="install-content">
            <span class="install-icon">📱</span>
            <div class="install-text">
                <strong>Install AI Tutor</strong>
                <span>Add to your home screen for quick access</span>
            </div>
            <button id="installBtn" class="btn btn-primary btn-sm">Install</button>
            <button id="dismissInstallBtn" class="btn-icon" aria-label="Dismiss">×</button>
        </div>
    </div>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen" role="status" aria-live="polite">
        <div class="loading-content">
            <div class="logo">🎓</div>
            <h1>AI Personal Tutor</h1>
            <div class="loading-spinner"></div>
            <p id="loadingStatus">Initializing AI model...</p>
            <div class="progress-container">
                <div id="loadingProgress" class="progress-bar"></div>
            </div>
            <p class="loading-info">First load may take a few minutes to download the AI model (~2.4GB)</p>
            <p class="loading-info">Subsequent loads will be much faster (cached locally)</p>
        </div>
    </div>

    <!-- Main App -->
    <div id="app" class="app-container" style="display: none;" role="application">
        <!-- Header -->
        <header class="main-header" role="banner">
            <div class="header-content">
                <h1>🎓 AI Personal Tutor</h1>
                <p class="subtitle">Powered by Phi-3-mini - Running 100% in your browser, completely free!</p>
                <div class="header-badges">
                    <span class="badge">✨ No API Keys</span>
                    <span class="badge">🔒 Privacy First</span>
                    <span class="badge">🚀 Open Source</span>
                    <span class="badge">💻 Runs Locally</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar" role="complementary" aria-label="Session settings and controls">
                <div class="sidebar-section">
                    <h3>📊 Session Info</h3>
                    <div id="sessionInfo" class="info-box">
                        <p><strong>Status:</strong> <span id="modelStatus">Ready</span></p>
                        <p><strong>Model:</strong> Phi-3-mini-4k</p>
                        <p id="topicDisplay" style="display: none;"><strong>Topic:</strong> <span id="currentTopic"></span></p>
                        <p id="durationDisplay" style="display: none;"><strong>Duration:</strong> <span id="sessionDuration">0:00</span></p>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>🎯 Learning Preferences</h3>
                    <div class="form-group">
                        <label for="learningStyle">Learning Style:</label>
                        <select id="learningStyle" class="form-control">
                            <option value="balanced">Balanced</option>
                            <option value="visual">Visual</option>
                            <option value="auditory">Auditory</option>
                            <option value="reading">Reading/Writing</option>
                            <option value="kinesthetic">Kinesthetic</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="difficultyLevel">Difficulty Level:</label>
                        <select id="difficultyLevel" class="form-control">
                            <option value="beginner">Beginner</option>
                            <option value="intermediate" selected>Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>⚙️ Settings</h3>
                    <div class="form-group">
                        <label for="temperature">Creativity Level: <span id="tempValue">0.7</span></label>
                        <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7" class="slider">
                    </div>
                </div>

                <div class="sidebar-section">
                    <button id="newSessionBtn" class="btn btn-secondary btn-block">🔄 New Session</button>
                    <button id="exportBtn" class="btn btn-secondary btn-block">💾 Export Chat</button>
                </div>

                <div class="sidebar-section info-section">
                    <h4>ℹ️ About This AI</h4>
                    <p class="small-text">This tutor uses Microsoft's Phi-3-mini, a powerful 3.8B parameter model running entirely in your browser. No data is sent to any server - everything stays private on your device!</p>
                </div>
            </aside>

            <!-- Chat Area -->
            <main class="chat-container" role="main">
                <!-- Welcome Screen -->
                <div id="welcomeScreen" class="welcome-screen">
                    <div class="welcome-content">
                        <h2>Welcome to Your AI Personal Tutor! 🎓</h2>
                        <p class="welcome-text">Get personalized, interactive learning on any topic - completely free and private.</p>
                        
                        <div class="features-grid">
                            <div class="feature-card">
                                <div class="feature-icon">🎯</div>
                                <h3>Personalized Learning</h3>
                                <p>Adaptive teaching that adjusts to your pace and style</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">🤔</div>
                                <h3>Socratic Method</h3>
                                <p>Learn through guided questions and discovery</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">🔄</div>
                                <h3>Interactive Practice</h3>
                                <p>Hands-on exercises and real-world applications</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">🔒</div>
                                <h3>100% Private</h3>
                                <p>All processing happens in your browser - no data leaves your device</p>
                            </div>
                        </div>

                        <div class="topic-input-container">
                            <h3>What would you like to learn today?</h3>
                            <div class="input-group">
                                <input 
                                    type="text" 
                                    id="topicInput" 
                                    class="topic-input" 
                                    placeholder="e.g., Machine Learning basics, Spanish grammar, Quantum physics..."
                                    autocomplete="off"
                                >
                                <button id="startLearningBtn" class="btn btn-primary btn-large">🚀 Start Learning</button>
                            </div>
                            <div class="example-topics">
                                <p>Try these examples:</p>
                                <button class="example-btn" data-topic="Machine Learning fundamentals">Machine Learning fundamentals</button>
                                <button class="example-btn" data-topic="Spanish conversational phrases">Spanish conversational phrases</button>
                                <button class="example-btn" data-topic="Web Development with HTML and CSS">Web Development with HTML and CSS</button>
                                <button class="example-btn" data-topic="Basic calculus concepts">Basic calculus concepts</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Messages -->
                <div id="chatMessages" class="chat-messages" style="display: none;" 
                     role="log" aria-live="polite" aria-atomic="false" aria-relevant="additions"></div>

                <!-- Chat Input -->
                <div id="chatInputContainer" class="chat-input-container" style="display: none;">
                    <div class="input-group">
                        <input 
                            type="text" 
                            id="chatInput" 
                            class="chat-input" 
                            placeholder="Type your response or ask a question..."
                            autocomplete="off"
                            aria-label="Chat message input"
                        >
                        <button id="sendBtn" class="btn btn-primary" aria-label="Send message">Send</button>
                    </div>
                    <div class="input-hints">
                        <span class="hint">💡 Tip: Press Enter to send, Shift+Enter for new line</span>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Browser Compatibility Warning -->
    <div id="compatibilityWarning" class="compatibility-warning" style="display: none;">
        <div class="warning-content">
            <h2>⚠️ Browser Not Supported</h2>
            <p>This application requires WebGPU support to run the AI model in your browser.</p>
            <p><strong>Recommended browsers:</strong></p>
            <ul>
                <li>Chrome 113+ (recommended)</li>
                <li>Edge 113+</li>
                <li>Opera 99+</li>
            </ul>
            <p>Please use one of these browsers and ensure WebGPU is enabled.</p>
            <a href="https://webgpureport.org/" target="_blank" class="btn btn-primary">Check WebGPU Support</a>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="app.js"></script>
</body>
</html>
